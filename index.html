<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eva K-Pop Tour - Official Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Archivo:wght@400;600;800&display=swap');
        
        :root {
            --neon-pink: #ff007f;
            --neon-blue: #00f2ff;
            --glass: rgba(15, 15, 15, 0.8);
        }

        body { 
            font-family: 'Archivo', sans-serif; 
            background-color: #050505;
            color: white;
            margin: 0;
            background-image: radial-gradient(circle at 50% 50%, #1a0b1a 0%, #050505 100%);
            min-height: 100vh;
        }

        .font-header { font-family: 'Archivo Black', sans-serif; }

        .glass {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .kpop-card {
            transition: all 0.2s ease;
        }

        .kpop-card:active { transform: scale(0.97); }

        .tab-active {
            border-bottom: 3px solid var(--neon-pink);
            color: var(--neon-pink);
            text-shadow: 0 0 10px var(--neon-pink);
        }

        .progress-bar-fill {
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px var(--neon-pink);
        }
    </style>
</head>
<body class="pb-28">

    <!-- Header -->
    <header class="sticky top-0 z-50 glass border-b border-pink-900/30 p-4">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div>
                <h1 class="font-header italic text-xl tracking-tighter uppercase leading-none">
                    Eva <span class="text-pink-500">World Tour</span>
                </h1>
                <p id="current-date" class="text-[10px] uppercase font-bold opacity-50 tracking-widest mt-1"></p>
            </div>
            <div class="text-right">
                <div id="total-score" class="font-header text-3xl text-pink-500 drop-shadow-md">0</div>
                <div class="text-[8px] uppercase font-black opacity-40">Puntos Totales</div>
            </div>
        </div>
    </header>

    <main class="max-w-md mx-auto px-4 mt-6">
        
        <!-- Tabs -->
        <nav class="flex justify-around mb-8 text-xs font-black uppercase tracking-widest border-b border-white/5">
            <button onclick="App.setTab('missions')" id="tab-missions" class="tab-active py-3 px-4">Misiones</button>
            <button onclick="App.setTab('rewards')" id="tab-rewards" class="py-3 px-4">Premios</button>
            <button onclick="App.setTab('history')" id="tab-history" class="py-3 px-4">Tour Log</button>
        </nav>

        <!-- Dynamic Content -->
        <div id="view-container" class="space-y-3"></div>

    </main>

    <!-- Admin Controls -->
    <div class="fixed bottom-0 left-0 w-full p-4 glass border-t border-white/10 z-50 flex gap-4 justify-center">
        <button onclick="App.quickAdjust(10, 'Backstage Bonus')" class="flex-1 bg-blue-600/20 border border-blue-500 text-blue-400 font-black py-4 rounded-2xl uppercase text-xs tracking-tighter active:bg-blue-600/40">
            ‚≠ê Bono (+10)
        </button>
        <button onclick="App.quickAdjust(-10, 'Ticket Warning')" class="flex-1 bg-red-600/20 border border-red-500 text-red-400 font-black py-4 rounded-2xl uppercase text-xs tracking-tighter active:bg-red-600/40">
            ‚ö†Ô∏è Multa (-10)
        </button>
    </div>

    <script>
        const CONFIG = {
            missions: [
                { id: 'cama', label: 'Hacer la cama', pts: 5, max: 1, icon: 'üõèÔ∏è' },
                { id: 'dientes', label: 'Lavar Dientes', pts: 2, max: 3, icon: 'ü™•' },
                { id: 'dormir', label: 'Dormir sola', pts: 10, max: 1, icon: 'üåô' },
                { id: 'ba√±o', label: 'Ba√±arse sola', pts: 5, max: 1, icon: 'üöø' },
                { id: 'vestir', label: 'Vestirse sola', pts: 5, max: 1, icon: 'üëó' },
                { id: 'leer', label: 'Leer Libro', pts: 4, max: 2, icon: 'üìñ' },
                { id: 'tarea', label: 'Tarea / Dibujo', pts: 3, max: 2, icon: 'üé®' },
                { id: 'comida', label: 'Comida Sana', pts: 2, max: 3, icon: 'ü•¶' },
                { id: 'sincera', label: 'Sinceridad', pts: 5, max: 1, icon: 'ü§ù' },
                { id: 'suave', label: 'Hablar suave', pts: 3, max: 3, icon: 'ü§´' }
            ],
            rewards: [
                { id: 'w1', label: '√Ålbum Digital / Stickers', type: 'Semanal', pts: 175 },
                { id: 'w2', label: 'Cena Favorita / Merch', type: 'Semanal', pts: 350 },
                { id: 'm1', label: 'Lightstick / Ropa K-Pop', type: 'Mensual', pts: 700 },
                { id: 'm2', label: 'Evento Especial / VIP', type: 'Mensual', pts: 1400 }
            ]
        };

        const App = {
            currentTab: 'missions',
            state: {
                total: 0,
                dailyCounts: {},
                history: [],
                lastDate: ''
            },

            init() {
                this.load();
                this.checkDateReset();
                this.updateUI();
                
                const options = { weekday: 'long', day: 'numeric', month: 'long' };
                document.getElementById('current-date').innerText = new Date().toLocaleDateString('es-ES', options);
            },

            load() {
                const saved = localStorage.getItem('eva_tour_manager_v3');
                if (saved) {
                    this.state = JSON.parse(saved);
                }
            },

            save() {
                localStorage.setItem('eva_tour_manager_v3', JSON.stringify(this.state));
                this.updateUI();
            },

            checkDateReset() {
                const today = new Date().toLocaleDateString();
                if (this.state.lastDate !== today) {
                    this.state.dailyCounts = {};
                    this.state.lastDate = today;
                    this.save();
                }
            },

            setTab(tab) {
                this.currentTab = tab;
                document.querySelectorAll('nav button').forEach(b => b.classList.remove('tab-active'));
                document.getElementById(`tab-${tab}`).classList.add('tab-active');
                this.render();
            },

            addPoint(id) {
                const mission = CONFIG.missions.find(m => m.id === id);
                const count = this.state.dailyCounts[id] || 0;
                
                if (count < mission.max) {
                    this.state.dailyCounts[id] = count + 1;
                    this.state.history.push({
                        id: Date.now(),
                        label: mission.label,
                        pts: mission.pts,
                        date: new Date().toLocaleString('es-ES', { hour: '2-digit', minute: '2-digit' }),
                        fullDate: new Date().toLocaleDateString()
                    });
                    this.calculateTotal();
                    this.save();
                }
            },

            quickAdjust(pts, label) {
                this.state.history.push({
                    id: Date.now(),
                    label: label,
                    pts: pts,
                    date: new Date().toLocaleString('es-ES', { hour: '2-digit', minute: '2-digit' }),
                    fullDate: new Date().toLocaleDateString()
                });
                this.calculateTotal();
                this.save();
            },

            calculateTotal() {
                this.state.total = this.state.history.reduce((acc, curr) => acc + curr.pts, 0);
            },

            updateUI() {
                document.getElementById('total-score').innerText = this.state.total;
                this.render();
            },

            render() {
                const container = document.getElementById('view-container');
                container.innerHTML = '';

                if (this.currentTab === 'missions') {
                    CONFIG.missions.forEach(m => {
                        const count = this.state.dailyCounts[m.id] || 0;
                        const done = count >= m.max;
                        
                        const div = document.createElement('div');
                        div.className = `kpop-card glass p-4 rounded-2xl flex items-center justify-between border-l-4 ${done ? 'border-green-500 opacity-50' : 'border-pink-500'}`;
                        div.innerHTML = `
                            <div class="flex items-center gap-4">
                                <span class="text-2xl">${m.icon}</span>
                                <div>
                                    <h3 class="font-bold text-sm uppercase italic leading-tight">${m.label}</h3>
                                    <p class="text-[10px] font-black text-pink-400 tracking-wider">${m.pts} PUNTOS</p>
                                </div>
                            </div>
                            <button onclick="App.addPoint('${m.id}')" ${done ? 'disabled' : ''} 
                                    class="w-12 h-12 rounded-full font-header text-xl flex items-center justify-center ${done ? 'bg-gray-800 text-gray-500' : 'bg-pink-600 text-white shadow-lg shadow-pink-900/50'}">
                                ${done ? '‚úì' : '+'}
                            </button>
                        `;
                        container.appendChild(div);
                    });
                } else if (this.currentTab === 'rewards') {
                    CONFIG.rewards.forEach(r => {
                        const progress = Math.min(100, (this.state.total / r.pts) * 100);
                        const unlocked = progress >= 100;
                        
                        const div = document.createElement('div');
                        div.className = `glass p-4 rounded-2xl border ${unlocked ? 'border-green-500' : 'border-white/10'}`;
                        div.innerHTML = `
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <span class="text-[8px] font-black px-2 py-0.5 rounded-full ${r.type === 'Semanal' ? 'bg-blue-600' : 'bg-purple-600'} uppercase">${r.type}</span>
                                    <h4 class="font-bold text-sm uppercase italic mt-1">${r.label}</h4>
                                </div>
                                <div class="text-right">
                                    <span class="font-header text-lg ${unlocked ? 'text-green-400' : 'opacity-40'}">${r.pts}</span>
                                    <p class="text-[8px] font-black opacity-30 uppercase">Meta</p>
                                </div>
                            </div>
                            <div class="w-full h-2 bg-black rounded-full overflow-hidden">
                                <div class="progress-bar-fill h-full bg-pink-500" style="width: ${progress}%"></div>
                            </div>
                        `;
                        container.appendChild(div);
                    });
                } else {
                    const recent = [...this.state.history].reverse().slice(0, 20);
                    if (recent.length === 0) {
                        container.innerHTML = `<p class="text-center opacity-30 italic py-10">Sin actividad registrada a√∫n...</p>`;
                        return;
                    }
                    recent.forEach(h => {
                        const div = document.createElement('div');
                        div.className = "flex justify-between items-center py-3 border-b border-white/5 px-2";
                        div.innerHTML = `
                            <div>
                                <p class="text-xs font-bold uppercase italic">${h.label}</p>
                                <p class="text-[9px] opacity-40 uppercase font-bold">${h.date} - ${h.fullDate}</p>
                            </div>
                            <span class="font-header ${h.pts >= 0 ? 'text-green-400' : 'text-red-400'}">
                                ${h.pts >= 0 ? '+' : ''}${h.pts}
                            </span>
                        `;
                        container.appendChild(div);
                    });
                }
            }
        };

        window.onload = () => App.init();
    </script>
</body>
</html>
